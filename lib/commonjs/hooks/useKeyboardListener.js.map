{"version":3,"names":["shouldTrackKeyboard","Platform","OS","useKeyboardEvent","eventType","callback","useEffect","listener","Keyboard","addListener","remove","useKeyboardListener","useSafeNestableScrollContainerContext","outerScrollOffset","scrollableRef","onKeyboardShown","useCallback","e","keyboardHeight","endCoordinates","height","currentInput","TextInput","State","currentlyFocusedInput","measure","originX","originY","width","pageX","pageY","yFromTop","componentHeight","screenHeight","Dimensions","get","yFromBottom","hiddenOffset","margin","current","scrollTo","animated","y","value"],"sources":["useKeyboardListener.tsx"],"sourcesContent":["import { useCallback, useEffect } from \"react\";\r\nimport {\r\n  Dimensions,\r\n  Keyboard,\r\n  KeyboardEvent,\r\n  KeyboardEventName,\r\n  Platform,\r\n  TextInput,\r\n} from \"react-native\";\r\nimport { useSafeNestableScrollContainerContext } from \"../context/nestableScrollContainerContext\";\r\n\r\nconst shouldTrackKeyboard = Platform.OS === \"ios\";\r\n\r\nfunction useKeyboardEvent(\r\n  eventType: KeyboardEventName,\r\n  callback: ((e: KeyboardEvent) => void) | null\r\n) {\r\n  useEffect(() => {\r\n    if (!callback) {\r\n      return;\r\n    }\r\n\r\n    const listener = Keyboard.addListener(eventType, callback);\r\n    return () => listener.remove();\r\n  }, [eventType, callback]);\r\n}\r\n\r\nexport default function useKeyboardListener() {\r\n  const {\r\n    outerScrollOffset,\r\n    scrollableRef,\r\n  } = useSafeNestableScrollContainerContext();\r\n\r\n  const onKeyboardShown = useCallback((e: KeyboardEvent) => {\r\n    const keyboardHeight = e.endCoordinates.height;\r\n    const currentInput = TextInput.State.currentlyFocusedInput();\r\n\r\n    if (!currentInput) {\r\n      return;\r\n    }\r\n\r\n    currentInput.measure((originX, originY, width, height, pageX, pageY) => {\r\n      const yFromTop = pageY;\r\n      const componentHeight = height;\r\n      const screenHeight = Dimensions.get(\"window\").height;\r\n      const yFromBottom = screenHeight - yFromTop - componentHeight;\r\n      const hiddenOffset = keyboardHeight - yFromBottom;\r\n      const margin = 32;\r\n      if (hiddenOffset > 0) {\r\n        scrollableRef.current?.scrollTo({\r\n          animated: true,\r\n          y: outerScrollOffset.value + hiddenOffset + margin,\r\n        });\r\n      }\r\n    });\r\n  }, []);\r\n\r\n  useKeyboardEvent(\r\n    \"keyboardDidShow\",\r\n    shouldTrackKeyboard ? onKeyboardShown : null\r\n  );\r\n}\r\n"],"mappings":"6FAAA,4BACA,yCAQA,yFAEA,GAAMA,oBAAmB,CAAGC,qBAAA,CAASC,EAAT,GAAgB,KAA5C,CAEA,QAASC,iBAAT,CACEC,SADF,CAEEC,QAFF,CAGE,CACA,GAAAC,gBAAA,EAAU,UAAM,CACd,GAAI,CAACD,QAAL,CAAe,CACb,OACD,CAED,GAAME,SAAQ,CAAGC,qBAAA,CAASC,WAAT,CAAqBL,SAArB,CAAgCC,QAAhC,CAAjB,CACA,MAAO,kBAAME,SAAQ,CAACG,MAAT,EAAN,EAAP,CACD,CAPD,CAOG,CAACN,SAAD,CAAYC,QAAZ,CAPH,EAQD,CAEc,QAASM,oBAAT,EAA+B,2BAIxC,GAAAC,qEAAA,GAJwC,CAE1CC,iBAF0C,uBAE1CA,iBAF0C,CAG1CC,aAH0C,uBAG1CA,aAH0C,CAM5C,GAAMC,gBAAe,CAAG,GAAAC,kBAAA,EAAY,SAACC,CAAD,CAAsB,CACxD,GAAMC,eAAc,CAAGD,CAAC,CAACE,cAAF,CAAiBC,MAAxC,CACA,GAAMC,aAAY,CAAGC,sBAAA,CAAUC,KAAV,CAAgBC,qBAAhB,EAArB,CAEA,GAAI,CAACH,YAAL,CAAmB,CACjB,OACD,CAEDA,YAAY,CAACI,OAAb,CAAqB,SAACC,OAAD,CAAUC,OAAV,CAAmBC,KAAnB,CAA0BR,MAA1B,CAAkCS,KAAlC,CAAyCC,KAAzC,CAAmD,CACtE,GAAMC,SAAQ,CAAGD,KAAjB,CACA,GAAME,gBAAe,CAAGZ,MAAxB,CACA,GAAMa,aAAY,CAAGC,uBAAA,CAAWC,GAAX,CAAe,QAAf,EAAyBf,MAA9C,CACA,GAAMgB,YAAW,CAAGH,YAAY,CAAGF,QAAf,CAA0BC,eAA9C,CACA,GAAMK,aAAY,CAAGnB,cAAc,CAAGkB,WAAtC,CACA,GAAME,OAAM,CAAG,EAAf,CACA,GAAID,YAAY,CAAG,CAAnB,CAAsB,2BACpB,uBAAAvB,aAAa,CAACyB,OAAd,qCAAuBC,QAAvB,CAAgC,CAC9BC,QAAQ,CAAE,IADoB,CAE9BC,CAAC,CAAE7B,iBAAiB,CAAC8B,KAAlB,CAA0BN,YAA1B,CAAyCC,MAFd,CAAhC,EAID,CACF,CAbD,EAcD,CAtBuB,CAsBrB,EAtBqB,CAAxB,CAwBAnC,gBAAgB,CACd,iBADc,CAEdH,mBAAmB,CAAGe,eAAH,CAAqB,IAF1B,CAAhB,CAID"}