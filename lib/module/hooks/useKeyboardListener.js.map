{"version":3,"names":["useCallback","useEffect","Dimensions","Keyboard","Platform","TextInput","useSafeNestableScrollContainerContext","shouldTrackKeyboard","OS","useKeyboardEvent","eventType","callback","listener","addListener","remove","useKeyboardListener","outerScrollOffset","scrollableRef","onKeyboardShown","e","keyboardHeight","endCoordinates","height","currentInput","State","currentlyFocusedInput","measure","originX","originY","width","pageX","pageY","yFromTop","componentHeight","screenHeight","get","yFromBottom","hiddenOffset","margin","current","scrollTo","animated","y","value"],"sources":["useKeyboardListener.tsx"],"sourcesContent":["import { useCallback, useEffect } from \"react\";\r\nimport {\r\n  Dimensions,\r\n  Keyboard,\r\n  KeyboardEvent,\r\n  KeyboardEventName,\r\n  Platform,\r\n  TextInput,\r\n} from \"react-native\";\r\nimport { useSafeNestableScrollContainerContext } from \"../context/nestableScrollContainerContext\";\r\n\r\nconst shouldTrackKeyboard = Platform.OS === \"ios\";\r\n\r\nfunction useKeyboardEvent(\r\n  eventType: KeyboardEventName,\r\n  callback: ((e: KeyboardEvent) => void) | null\r\n) {\r\n  useEffect(() => {\r\n    if (!callback) {\r\n      return;\r\n    }\r\n\r\n    const listener = Keyboard.addListener(eventType, callback);\r\n    return () => listener.remove();\r\n  }, [eventType, callback]);\r\n}\r\n\r\nexport default function useKeyboardListener() {\r\n  const {\r\n    outerScrollOffset,\r\n    scrollableRef,\r\n  } = useSafeNestableScrollContainerContext();\r\n\r\n  const onKeyboardShown = useCallback((e: KeyboardEvent) => {\r\n    const keyboardHeight = e.endCoordinates.height;\r\n    const currentInput = TextInput.State.currentlyFocusedInput();\r\n\r\n    if (!currentInput) {\r\n      return;\r\n    }\r\n\r\n    currentInput.measure((originX, originY, width, height, pageX, pageY) => {\r\n      const yFromTop = pageY;\r\n      const componentHeight = height;\r\n      const screenHeight = Dimensions.get(\"window\").height;\r\n      const yFromBottom = screenHeight - yFromTop - componentHeight;\r\n      const hiddenOffset = keyboardHeight - yFromBottom;\r\n      const margin = 32;\r\n      if (hiddenOffset > 0) {\r\n        scrollableRef.current?.scrollTo({\r\n          animated: true,\r\n          y: outerScrollOffset.value + hiddenOffset + margin,\r\n        });\r\n      }\r\n    });\r\n  }, []);\r\n\r\n  useKeyboardEvent(\r\n    \"keyboardDidShow\",\r\n    shouldTrackKeyboard ? onKeyboardShown : null\r\n  );\r\n}\r\n"],"mappings":"AAAA,SAASA,WAAT,EAAsBC,SAAtB,QAAuC,OAAvC;AACA,SACEC,UADF,EAEEC,QAFF,EAKEC,QALF,EAMEC,SANF,QAOO,cAPP;AAQA,SAASC,qCAAT,QAAsD,2CAAtD;AAEA,MAAMC,mBAAmB,GAAGH,QAAQ,CAACI,EAAT,KAAgB,KAA5C;;AAEA,SAASC,gBAAT,CACEC,SADF,EAEEC,QAFF,EAGE;EACAV,SAAS,CAAC,MAAM;IACd,IAAI,CAACU,QAAL,EAAe;MACb;IACD;;IAED,MAAMC,QAAQ,GAAGT,QAAQ,CAACU,WAAT,CAAqBH,SAArB,EAAgCC,QAAhC,CAAjB;IACA,OAAO,MAAMC,QAAQ,CAACE,MAAT,EAAb;EACD,CAPQ,EAON,CAACJ,SAAD,EAAYC,QAAZ,CAPM,CAAT;AAQD;;AAED,eAAe,SAASI,mBAAT,GAA+B;EAC5C,MAAM;IACJC,iBADI;IAEJC;EAFI,IAGFX,qCAAqC,EAHzC;EAKA,MAAMY,eAAe,GAAGlB,WAAW,CAAEmB,CAAD,IAAsB;IACxD,MAAMC,cAAc,GAAGD,CAAC,CAACE,cAAF,CAAiBC,MAAxC;IACA,MAAMC,YAAY,GAAGlB,SAAS,CAACmB,KAAV,CAAgBC,qBAAhB,EAArB;;IAEA,IAAI,CAACF,YAAL,EAAmB;MACjB;IACD;;IAEDA,YAAY,CAACG,OAAb,CAAqB,CAACC,OAAD,EAAUC,OAAV,EAAmBC,KAAnB,EAA0BP,MAA1B,EAAkCQ,KAAlC,EAAyCC,KAAzC,KAAmD;MACtE,MAAMC,QAAQ,GAAGD,KAAjB;MACA,MAAME,eAAe,GAAGX,MAAxB;MACA,MAAMY,YAAY,GAAGhC,UAAU,CAACiC,GAAX,CAAe,QAAf,EAAyBb,MAA9C;MACA,MAAMc,WAAW,GAAGF,YAAY,GAAGF,QAAf,GAA0BC,eAA9C;MACA,MAAMI,YAAY,GAAGjB,cAAc,GAAGgB,WAAtC;MACA,MAAME,MAAM,GAAG,EAAf;;MACA,IAAID,YAAY,GAAG,CAAnB,EAAsB;QAAA;;QACpB,yBAAApB,aAAa,CAACsB,OAAd,gFAAuBC,QAAvB,CAAgC;UAC9BC,QAAQ,EAAE,IADoB;UAE9BC,CAAC,EAAE1B,iBAAiB,CAAC2B,KAAlB,GAA0BN,YAA1B,GAAyCC;QAFd,CAAhC;MAID;IACF,CAbD;EAcD,CAtBkC,EAsBhC,EAtBgC,CAAnC;EAwBA7B,gBAAgB,CACd,iBADc,EAEdF,mBAAmB,GAAGW,eAAH,GAAqB,IAF1B,CAAhB;AAID"}